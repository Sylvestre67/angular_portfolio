tinymce.PluginManager.add("importcss",function(e){var c=this,f=tinymce.each;function b(i){var j=e.settings,k=j.skin!==false?j.skin||"lightgray":false;if(k){var h=j.skin_url;if(h){h=e.documentBaseURI.toAbsolute(h)}else{h=tinymce.baseURL+"/skins/"+k}return i===h+"/content"+(e.inline?".inline":"")+".min.css"}return false}function d(h){if(typeof h=="string"){return function(i){return i.indexOf(h)!==-1}}else{if(h instanceof RegExp){return function(i){return h.test(i)}}}return h}function a(m,k){var j=[],i={};function h(r,q){var n=r.href,p;if(!n||!k(n,q)||b(n)){return}f(r.imports,function(s){h(s,true)});try{p=r.cssRules||r.rules}catch(o){}f(p,function(s){if(s.styleSheet){h(s.styleSheet,true)}else{if(s.selectorText){f(s.selectorText.split(","),function(t){j.push(tinymce.trim(t))})}}})}f(e.contentCSS,function(n){i[n]=true});if(!k){k=function(n,o){return o||i[n]}}try{f(m.styleSheets,function(n){h(n)})}catch(l){}return j}function g(l){var m;var i=/^(?:([a-z0-9\-_]+))?(\.[a-z0-9_\-\.]+)$/i.exec(l);if(!i){return}var h=i[1];var j=i[2].substr(1).split(".").join(" ");var k=tinymce.makeMap("a,img");if(i[1]){m={title:l};if(e.schema.getTextBlockElements()[h]){m.block=h}else{if(e.schema.getBlockElements()[h]||k[h.toLowerCase()]){m.selector=h}else{m.inline=h}}}else{if(i[2]){m={inline:"span",title:l.substr(1),classes:j}}}if(e.settings.importcss_merge_classes!==false){m.classes=j}else{m.attributes={"class":j}}return m}e.on("renderFormatsMenu",function(n){var k=e.settings,j={};var i=k.importcss_selector_converter||g;var m=d(k.importcss_selector_filter),l=n.control;if(!e.settings.importcss_append){l.items().remove()}var h=[];tinymce.each(k.importcss_groups,function(o){o=tinymce.extend({},o);o.filter=d(o.filter);h.push(o)});f(a(n.doc||e.getDoc(),d(k.importcss_file_filter)),function(o){if(o.indexOf(".mce-")===-1){if(!j[o]&&(!m||m(o))){var s=i.call(c,o),t;if(s){var r=s.name||tinymce.DOM.uniqueId();if(h){for(var p=0;p<h.length;p++){if(!h[p].filter||h[p].filter(o)){if(!h[p].item){h[p].item={text:h[p].title,menu:[]}}t=h[p].item.menu;break}}}e.formatter.register(r,s);var q=tinymce.extend({},l.settings.itemDefaults,{text:s.title,format:r});if(t){t.push(q)}else{l.add(q)}}j[o]=true}}});f(h,function(o){l.add(o.item)});n.control.renderNew()});c.convertSelectorToFormat=g});