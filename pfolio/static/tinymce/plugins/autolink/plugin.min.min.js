tinymce.PluginManager.add("autolink",function(k){var h;k.on("keydown",function(a){if(a.keyCode==13){return l(k)}});if(tinymce.Env.ie){k.on("focus",function(){if(!h){h=true;try{k.execCommand("AutoUrlDetect",false,true)}catch(a){}}});return}k.on("keypress",function(a){if(a.keyCode==41){return j(k)}});k.on("keyup",function(a){if(a.keyCode==32){return g(k)}});function j(a){i(a,-1,"(",true)}function g(a){i(a,0,"",true)}function l(a){i(a,-1,"",false)}function i(c,x,A){var B,f,y,C,F,D,e,w,d,E;function z(m,o){if(o<0){o=0}if(m.nodeType==3){var n=m.data.length;if(o>n){o=n}}return o}function a(n,m){if(n.nodeType!=1||n.hasChildNodes()){B.setStart(n,z(n,m))}else{B.setStartBefore(n)}}function b(n,m){if(n.nodeType!=1||n.hasChildNodes()){B.setEnd(n,z(n,m))}else{B.setEndAfter(n)}}if(c.selection.getNode().tagName=="A"){return}B=c.selection.getRng(true).cloneRange();if(B.startOffset<5){w=B.endContainer.previousSibling;if(!w){if(!B.endContainer.firstChild||!B.endContainer.firstChild.nextSibling){return}w=B.endContainer.firstChild.nextSibling}d=w.length;a(w,d);b(w,d);if(B.endOffset<5){return}f=B.endOffset;C=w}else{C=B.endContainer;if(C.nodeType!=3&&C.firstChild){while(C.nodeType!=3&&C.firstChild){C=C.firstChild}if(C.nodeType==3){a(C,0);b(C,C.nodeValue.length)}}if(B.endOffset==1){f=2}else{f=B.endOffset-1-x}}y=f;do{a(C,f>=2?f-2:0);b(C,f>=1?f-1:0);f-=1;E=B.toString()}while(E!=" "&&E!==""&&E.charCodeAt(0)!=160&&(f-2)>=0&&E!=A);if(B.toString()==A||B.toString().charCodeAt(0)==160){a(C,f);b(C,y);f+=1}else{if(B.startOffset===0){a(C,0);b(C,y)}else{a(C,f);b(C,y)}}D=B.toString();if(D.charAt(D.length-1)=="."){b(C,y-1)}D=B.toString();e=D.match(/^(https?:\/\/|ssh:\/\/|ftp:\/\/|file:\/|www\.|(?:mailto:)?[A-Z0-9._%+\-]+@)(.+)$/i);if(e){if(e[1]=="www."){e[1]="http://www."}else{if(/@$/.test(e[1])&&!/^mailto:/.test(e[1])){e[1]="mailto:"+e[1]}}F=c.selection.getBookmark();c.selection.setRng(B);c.execCommand("createlink",false,e[1]+e[2]);c.selection.moveToBookmark(F);c.nodeChanged()}}});