tinymce.PluginManager.add("textcolor",function(o){var n,k;k=o.settings.textcolor_rows||5;n=o.settings.textcolor_cols||8;function t(a){var b;o.dom.getParents(o.selection.getStart(),function(d){var c;if((c=d.style[a=="forecolor"?"color":"background-color"])){b=c}});return b}function m(){var a,c=[],b;b=o.settings.textcolor_map||["000000","Black","993300","Burnt orange","333300","Dark olive","003300","Dark green","003366","Dark azure","000080","Navy Blue","333399","Indigo","333333","Very dark gray","800000","Maroon","FF6600","Orange","808000","Olive","008000","Green","008080","Teal","0000FF","Blue","666699","Grayish blue","808080","Gray","FF0000","Red","FF9900","Amber","99CC00","Yellow green","339966","Sea green","33CCCC","Turquoise","3366FF","Royal blue","800080","Purple","999999","Medium gray","FF00FF","Magenta","FFCC00","Gold","FFFF00","Yellow","00FF00","Lime","00FFFF","Aqua","00CCFF","Sky blue","993366","Red violet","FFFFFF","White","FF99CC","Pink","FFCC99","Peach","FFFF99","Light yellow","CCFFCC","Pale green","CCFFFF","Pale cyan","99CCFF","Light sky blue","CC99FF","Plum"];for(a=0;a<b.length;a+=2){c.push({text:b[a+1],color:"#"+b[a]})}return c}function s(){var h=this,g,e,c,i,j,v,d,f=h._id,b=0;function a(z,u){var y=z=="transparent";return('<td class="mce-grid-cell'+(y?" mce-colorbtn-trans":"")+'"><div id="'+f+"-"+(b++)+'" data-mce-color="'+(z?z:"")+'" role="option" tabIndex="-1" style="'+(z?"background-color: "+z:"")+'" title="'+tinymce.translate(u)+'">'+(y?"&#215;":"")+"</div></td>")}g=m();g.push({text:tinymce.translate("No color"),color:"transparent"});c='<table class="mce-grid mce-grid-border mce-colorbutton-grid" role="list" cellspacing="0"><tbody>';i=g.length-1;for(v=0;v<k;v++){c+="<tr>";for(j=0;j<n;j++){d=v*n+j;if(d>i){c+="<td></td>"}else{e=g[d];c+=a(e.color,e.text)}}c+="</tr>"}if(o.settings.color_picker_callback){c+=('<tr><td colspan="'+n+'" class="mce-custom-color-btn"><div id="'+f+'-c" class="mce-widget mce-btn mce-btn-small mce-btn-flat" role="button" tabindex="-1" aria-labelledby="'+f+'-c" style="width: 100%"><button type="button" role="presentation" tabindex="-1">'+tinymce.translate("Custom...")+"</button></div></td></tr>");c+="<tr>";for(j=0;j<n;j++){c+=a("","Custom color")}c+="</tr>"}c+="</tbody></table>";return c}function r(a,b){o.undoManager.transact(function(){o.focus();o.formatter.apply(a,{value:b});o.nodeChanged()})}function l(a){o.undoManager.transact(function(){o.focus();o.formatter.remove(a,{value:null},null,true);o.nodeChanged()})}function q(d){var a=this.parent(),e;function b(g){a.hidePanel();a.color(g);r(a.settings.format,g)}function f(){a.hidePanel();a.resetColor();l(a.settings.format)}function c(g,h){g.style.background=h;g.setAttribute("data-mce-color",h)}if(tinymce.DOM.getParent(d.target,".mce-custom-color-btn")){a.hidePanel();o.settings.color_picker_callback.call(o,function(h){var v=a.panel.getEl().getElementsByTagName("table")[0];var i,g,j;i=tinymce.map(v.rows[v.rows.length-1].childNodes,function(u){return u.firstChild});for(j=0;j<i.length;j++){g=i[j];if(!g.getAttribute("data-mce-color")){break}}if(j==n){for(j=0;j<n-1;j++){c(i[j],i[j+1].getAttribute("data-mce-color"))}}c(g,h);b(h)},t(a.settings.format))}e=d.target.getAttribute("data-mce-color");if(e){if(this.lastId){document.getElementById(this.lastId).setAttribute("aria-selected",false)}d.target.setAttribute("aria-selected",true);this.lastId=d.target.id;if(e=="transparent"){f()}else{b(e)}}else{if(e!==null){a.hidePanel()}}}function p(){var a=this;if(a._color){r(a.settings.format,a._color)}else{l(a.settings.format)}}o.addButton("forecolor",{type:"colorbutton",tooltip:"Text color",format:"forecolor",panel:{role:"application",ariaRemember:true,html:s,onclick:q},onclick:p});o.addButton("backcolor",{type:"colorbutton",tooltip:"Background color",format:"hilitecolor",panel:{role:"application",ariaRemember:true,html:s,onclick:q},onclick:p})});