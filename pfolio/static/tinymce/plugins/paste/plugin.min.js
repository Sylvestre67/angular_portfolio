(function(b,g){var d={};function c(m,n){var l,j=[];for(var k=0;k<m.length;++k){l=d[m[k]]||e(m[k]);if(!l){throw"module definition dependecy not found: "+m[k]}j.push(l)}n.apply(null,j)}function h(k,j,i){if(typeof k!=="string"){throw"invalid module definition, module id must be defined and be a string"}if(j===g){throw"invalid module definition, dependencies must be specified"}if(i===g){throw"invalid module definition, definition function must be specified"}c(j,function(){d[k]=i.apply(null,arguments)})}function f(i){return !!d[i]}function e(l){var j=b;var i=l.split(/[.\/]/);for(var k=0;k<i.length;++k){if(!j[i[k]]){return}j=j[i[k]]}return j}function a(l){var k,n,p,j,m;for(k=0;k<l.length;k++){n=b;p=l[k];j=p.split(/[.\/]/);for(var o=0;o<j.length-1;++o){if(n[j[o]]===g){n[j[o]]={}}n=n[j[o]]}n[j[j.length-1]]=d[p]}if(b.AMDLC_TESTS){m=b.privateModules||{};for(p in d){m[p]=d[p]}for(k=0;k<l.length;k++){delete m[l[k]]}b.privateModules=m}}h("tinymce/pasteplugin/Utils",["tinymce/util/Tools","tinymce/html/DomParser","tinymce/html/Schema"],function(i,n,l){function k(p,o){i.each(o,function(q){if(q.constructor==RegExp){p=p.replace(q,"")}else{p=p.replace(q[0],q[1])}});return p}function m(r){var t=new l(),v=new n({},t),u="";var q=t.getShortEndedElements();var p=i.makeMap("script noscript style textarea video audio iframe object"," ");var s=t.getBlockElements();function o(y){var w=y.name,x=y;if(w==="br"){u+="\n";return}if(q[w]){u+=" "}if(p[w]){u+=" ";return}if(y.type==3){u+=y.value}if(!y.shortEnded){if((y=y.firstChild)){do{o(y)}while((y=y.next))}}if(s[w]&&x.next){u+="\n";if(w=="p"){u+="\n"}}}r=k(r,[/<!\[[^\]]+\]>/g]);o(v.parse(r));return u}function j(o){function p(s,r,q){if(!r&&!q){return" "}return"\u00a0"}o=k(o,[/^[\s\S]*<body[^>]*>\s*|\s*<\/body[^>]*>[\s\S]*$/g,/<!--StartFragment-->|<!--EndFragment-->/g,[/( ?)<span class="Apple-converted-space">\u00a0<\/span>( ?)/g,p],/<br class="Apple-interchange-newline">/g,/<br>$/i]);return o}return{filter:k,innerText:m,trimHtml:j}});h("tinymce/pasteplugin/Clipboard",["tinymce/Env","tinymce/dom/RangeUtils","tinymce/util/VK","tinymce/pasteplugin/Utils","tinymce/util/Delay"],function(i,j,l,k,m){return function(r){var A=this,p,F,o=0,E=false;var s="%MCEPASTEBIN%",G;var t="data:text/mce-internal,";function C(N){var M,O=r.dom;M=r.fire("BeforePastePreProcess",{content:N});M=r.fire("PastePreProcess",M);N=M.content;if(!M.isDefaultPrevented()){if(r.hasEventListeners("PastePostProcess")&&!M.isDefaultPrevented()){var L=O.add(r.getBody(),"div",{style:"display:none"},N);M=r.fire("PastePostProcess",{node:L});O.remove(L);N=M.node.innerHTML}if(!M.isDefaultPrevented()){r.insertContent(N,{merge:r.settings.paste_merge_formats!==false,data:{paste:true}})}}}function D(O){O=r.dom.encode(O).replace(/\r\n/g,"\n");var M=r.dom.getParent(r.selection.getStart(),r.dom.isBlock);var L=r.settings.forced_root_block;var N;if(L){N=r.dom.createHTML(L,r.settings.forced_root_block_attrs);N=N.substr(0,N.length-3)+">"}if((M&&/^(PRE|DIV)$/.test(M.nodeName))||!L){O=k.filter(O,[[/\n/g,"<br>"]])}else{O=k.filter(O,[[/\n\n/g,"</p>"+N],[/^(.*<\/p>)(<p>)$/,N+"$1"],[/\n/g,"<br />"]]);if(O.indexOf("<p>")!=-1){O=N+O}}C(O)}function u(){var N=r.dom,O=r.getBody();var P=r.dom.getViewPort(r.getWin()),M=P.y,R=20;var T;F=r.selection.getRng();if(r.inline){T=r.selection.getScrollContainer();if(T&&T.scrollTop>0){M=T.scrollTop}}function Q(V){var W,Y,X,U=V.startContainer;W=V.getClientRects();if(W.length){return W[0]}if(!V.collapsed||U.nodeType!=1){return}X=U.childNodes[F.startOffset];while(X&&X.nodeType==3&&!X.data.length){X=X.nextSibling}if(!X){return}if(X.tagName=="BR"){Y=N.doc.createTextNode("\uFEFF");X.parentNode.insertBefore(Y,X);V=N.createRng();V.setStartBefore(Y);V.setEndAfter(Y);W=V.getClientRects();N.remove(Y)}if(W.length){return W[0]}}if(F.getClientRects){var S=Q(F);if(S){R=M+(S.top-N.getPos(O).y)}else{R=M;var L=F.startContainer;if(L){if(L.nodeType==3&&L.parentNode!=O){L=L.parentNode}if(L.nodeType==1){R=N.getPos(L,T||O).y}}}}p=N.add(r.getBody(),"div",{id:"mcepastebin",contentEditable:true,"data-mce-bogus":"all",style:"position: absolute; top: "+R+"px;width: 10px; height: 10px; overflow: hidden; opacity: 0"},s);if(i.ie||i.gecko){N.setStyle(p,"left",N.getStyle(O,"direction",true)=="rtl"?65535:-65535)}N.bind(p,"beforedeactivate focusin focusout",function(U){U.stopPropagation()});p.focus();r.selection.select(p,true)}function K(){if(p){var L;while((L=r.dom.get("mcepastebin"))){r.dom.remove(L);r.dom.unbind(L)}if(F){r.selection.setRng(F)}}p=F=null}function J(){var O="",M,N,P,L;M=r.dom.select("div[id=mcepastebin]");for(N=0;N<M.length;N++){P=M[N];if(P.firstChild&&P.firstChild.id=="mcepastebin"){P=P.firstChild}L=P.innerHTML;if(O!=s){O+=L}}return O}function v(P){var N,M,L,O;L=[25942,29554,28521,14958];for(N=0;N<L.length;N++){if(P.charCodeAt(N)!=L[N]){return P}}M="";for(N=0;N<P.length;N++){O=P.charCodeAt(N);M+=String.fromCharCode((O&255));M+=String.fromCharCode((O&65280)>>8)}return decodeURIComponent(escape(M))}function H(M){var L,N,O;N="<!--StartFragment-->";L=M.indexOf(N);if(L!==-1){M=M.substr(L+N.length)}O="<!--EndFragment-->";L=M.indexOf(O);if(L!==-1){M=M.substr(0,L)}return M}function y(O){var L={};if(O){if(O.getData){var Q=O.getData("Text");if(Q&&Q.length>0){if(Q.indexOf(t)==-1){L["text/plain"]=Q}}}if(O.types){for(var M=0;M<O.types.length;M++){var P=O.types[M],N=O.getData(P);if(P=="text/html"){N=H(v(N))}L[P]=N}}}return L}function x(L){return y(L.clipboardData||r.getDoc().dataTransfer)}function w(O,M){var N=O.clipboardData||O.dataTransfer;function L(Q){var S,T,P,U=false;function R(V){if(M){r.selection.setRng(M);M=null}C('<img src="'+V.result+'">')}if(Q){for(S=0;S<Q.length;S++){T=Q[S];if(/^image\/(jpeg|png|gif|bmp)$/.test(T.type)){P=new FileReader();P.onload=R.bind(null,P);P.readAsDataURL(T.getAsFile?T.getAsFile():T);O.preventDefault();U=true}}}return U}if(r.settings.paste_data_images&&N){return L(N.items)||L(N.files)}}function B(L){var M=L.clipboardData;return navigator.userAgent.indexOf("Android")!=-1&&M&&M.items&&M.items.length===0}function n(L){return j.getCaretRangeFromPoint(L.clientX,L.clientY,r.getDoc())}function z(L,M){return M in L&&L[M].length>0}function I(L){return(l.metaKeyPressed(L)&&L.keyCode==86)||(L.shiftKey&&L.keyCode==45)}function q(){r.on("keydown",function(M){function N(O){if(I(O)&&!O.isDefaultPrevented()){K()}}if(I(M)&&!M.isDefaultPrevented()){G=M.shiftKey&&M.keyCode==86;if(G&&i.webkit&&navigator.userAgent.indexOf("Version/")!=-1){return}M.stopImmediatePropagation();o=new Date().getTime();if(i.ie&&G){M.preventDefault();r.fire("paste",{ieFake:true});return}K();u();r.once("keyup",N);r.once("paste",function(){r.off("keyup",N)})}});function L(P,M,N){var O;if(z(P,"text/html")){O=P["text/html"]}else{O=J();if(O==s){N=true}}O=k.trimHtml(O);if(p&&p.firstChild&&p.firstChild.id==="mcepastebin"){N=true}K();if(!O.length){N=true}if(N){if(z(P,"text/plain")&&O.indexOf("</p>")==-1){O=P["text/plain"]}else{O=k.innerText(O)}}if(O==s){if(!M){r.windowManager.alert("Please use Ctrl+V/Cmd+V keyboard shortcuts to paste contents.")}return}if(N){D(O)}else{C(O)}}r.on("paste",function(Q){var R=new Date().getTime();var P=x(Q);var N=new Date().getTime()-R;var M=(new Date().getTime()-o-N)<1000;var O=A.pasteFormat=="text"||G;G=false;if(Q.isDefaultPrevented()||B(Q)){K();return}if(w(Q)){K();return}if(!M){Q.preventDefault()}if(i.ie&&(!M||Q.ieFake)){u();r.dom.bind(p,"paste",function(S){S.stopPropagation()});r.getDoc().execCommand("Paste",false,null);P["text/html"]=J()}if(z(P,"text/html")){Q.preventDefault();L(P,M,O)}else{m.setEditorTimeout(r,function(){L(P,M,O)},0)}});r.on("dragstart dragend",function(M){E=M.type=="dragstart"});r.on("drop",function(P){var M=n(P);if(P.isDefaultPrevented()||E){return}if(w(P,M)){return}if(M&&r.settings.paste_filter_drop!==false){var N=y(P.dataTransfer);var O=N["mce-internal"]||N["text/html"]||N["text/plain"];if(O){P.preventDefault();r.undoManager.transact(function(){if(N["mce-internal"]){r.execCommand("Delete")}r.selection.setRng(M);O=k.trimHtml(O);if(!N["text/html"]){D(O)}else{C(O)}})}}});r.on("dragover dragend",function(M){if(r.settings.paste_data_images){M.preventDefault()}})}A.pasteHtml=C;A.pasteText=D;r.on("preInit",function(){q();r.parser.addNodeFilter("img",function(N,M,S){function T(U){return U.data&&U.data.paste===true}function R(U){if(!U.attr("data-mce-object")&&L!==i.transparentSrc){U.remove()}}function O(U){return U.indexOf("webkit-fake-url")===0}function P(U){return U.indexOf("data:")===0}if(!r.settings.paste_data_images&&T(S)){var Q=N.length;while(Q--){var L=N[Q].attributes.map.src;if(!L){continue}if(O(L)){R(N[Q])}else{if(!r.settings.allow_html_data_urls&&P(L)){R(N[Q])}}}}})})}});h("tinymce/pasteplugin/WordFilter",["tinymce/util/Tools","tinymce/html/DomParser","tinymce/html/Schema","tinymce/html/Serializer","tinymce/html/Node","tinymce/pasteplugin/Utils"],function(i,r,l,n,m,k){function q(s){return((/<font face="Times New Roman"|class="?Mso|style="[^"]*\bmso-|style='[^'']*\bmso-|w:WordDocument/i).test(s)||(/class="OutlineElement/).test(s)||(/id="?docs\-internal\-guid\-/.test(s)))}function j(u){var t,s;s=[/^[IVXLMCD]{1,2}\.[ \u00a0]/,/^[ivxlmcd]{1,2}\.[ \u00a0]/,/^[a-z]{1,2}[\.\)][ \u00a0]/,/^[A-Z]{1,2}[\.\)][ \u00a0]/,/^[0-9]+\.[ \u00a0]/,/^[\u3007\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d]+\.[ \u00a0]/,/^[\u58f1\u5f10\u53c2\u56db\u4f0d\u516d\u4e03\u516b\u4e5d\u62fe]+\.[ \u00a0]/];u=u.replace(/^[\u00a0 ]+/,"");i.each(s,function(v){if(v.test(u)){t=true;return false}});return t}function o(s){return/^[\s\u00a0]*[\u2022\u00b7\u00a7\u25CF]\s*/.test(s)}function p(t){var s=t.settings;t.on("BeforePastePreProcess",function(A){var C=A.content,B,x;C=C.replace(/<b[^>]+id="?docs-internal-[^>]*>/gi,"");C=C.replace(/<br class="?Apple-interchange-newline"?>/gi,"");B=s.paste_retain_style_properties;if(B){x=i.makeMap(B.split(/[, ]/))}function z(K){var H,Q,F=1;function P(T){var S="";if(T.type===3){return T.value}if((T=T.firstChild)){do{S+=P(T)}while((T=T.next))}return S}function N(T,S){if(T.type===3){if(S.test(T.value)){T.value=T.value.replace(S,"");return false}}if((T=T.firstChild)){do{if(!N(T,S)){return false}}while((T=T.next))}return true}function J(S){if(S._listIgnore){S.remove();return}if((S=S.firstChild)){do{J(S)}while((S=S.next))}}function R(S,T,V){var U=S._listLevel||F;if(U!=F){if(U<F){if(H){H=H.parent.parent}}else{Q=H;H=null}}if(!H||H.name!=T){Q=Q||H;H=new m(T,1);if(V>1){H.attr("start",""+V)}S.wrap(H)}else{H.append(S)}S.name="li";if(U>F&&Q){Q.lastChild.append(H)}F=U;J(S);N(S,/^\u00a0+/);N(S,/^\s*([\u2022\u00b7\u00a7\u25CF]|\w+\.)/);N(S,/^\u00a0+/)}var E=[],I=K.firstChild;while(typeof I!=="undefined"&&I!==null){E.push(I);I=I.walk();if(I!==null){while(typeof I!=="undefined"&&I.parent!==K){I=I.walk()}}}for(var L=0;L<E.length;L++){K=E[L];if(K.name=="p"&&K.firstChild){var O=P(K);if(o(O)){R(K,"ul");continue}if(j(O)){var M=/([0-9]+)\./.exec(O);var G=1;if(M){G=parseInt(M[1],10)}R(K,"ol",G);continue}if(K._listLevel){R(K,"ul",1);continue}H=null}else{Q=H;H=null}}}function u(G,E){var I={},H,F=t.dom.parseStyle(E);i.each(F,function(K,J){switch(J){case"mso-list":H=/\w+ \w+([0-9]+)/i.exec(E);if(H){G._listLevel=parseInt(H[1],10)}if(/Ignore/i.test(K)&&G.firstChild){G._listIgnore=true;G.firstChild._listIgnore=true}break;case"horiz-align":J="text-align";break;case"vert-align":J="vertical-align";break;case"font-color":case"mso-foreground":J="color";break;case"mso-background":case"mso-highlight":J="background";break;case"font-weight":case"font-style":if(K!="normal"){I[J]=K}return;case"mso-element":if(/^(comment|comment-list)$/i.test(K)){G.remove();return}break}if(J.indexOf("mso-comment")===0){G.remove();return}if(J.indexOf("mso-")===0){return}if(B=="all"||(x&&x[J])){I[J]=K}});if(/(bold)/i.test(I["font-weight"])){delete I["font-weight"];G.wrap(new m("b",1))}if(/(italic)/i.test(I["font-style"])){delete I["font-style"];G.wrap(new m("i",1))}I=t.dom.serializeStyle(I,G.name);if(I){return I}return null}if(s.paste_enable_default_filters===false){return}if(q(A.content)){A.wordContent=true;C=k.filter(C,[/<!--[\s\S]+?-->/gi,/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|img|meta|link|style|\w:\w+)(?=[\s\/>]))[^>]*>/gi,[/<(\/?)s>/gi,"<$1strike>"],[/&nbsp;/gi,"\u00a0"],[/<span\s+style\s*=\s*"\s*mso-spacerun\s*:\s*yes\s*;?\s*"\s*>([\s\u00a0]*)<\/span>/gi,function(F,E){return(E.length>0)?E.replace(/./," ").slice(Math.floor(E.length/2)).split("").join("\u00a0"):""}]]);var v=s.paste_word_valid_elements;if(!v){v=("-strong/b,-em/i,-u,-span,-p,-ol,-ul,-li,-h1,-h2,-h3,-h4,-h5,-h6,-p/div,-a[href|name],sub,sup,strike,br,del,table[width],tr,td[colspan|rowspan|width],th[colspan|rowspan|width],thead,tfoot,tbody")}var y=new l({valid_elements:v,valid_children:"-li[p]"});i.each(y.elements,function(E){if(!E.attributes["class"]){E.attributes["class"]={};E.attributesOrder.push("class")}if(!E.attributes.style){E.attributes.style={};E.attributesOrder.push("style")}});var D=new r({},y);D.addAttributeFilter("style",function(E){var F=E.length,G;while(F--){G=E[F];G.attr("style",u(G,G.attr("style")));if(G.name=="span"&&G.parent&&!G.attributes.length){G.unwrap()}}});D.addAttributeFilter("class",function(E){var F=E.length,H,G;while(F--){H=E[F];G=H.attr("class");if(/^(MsoCommentReference|MsoCommentText|msoDel)$/i.test(G)){H.remove()}H.attr("class",null)}});D.addNodeFilter("del",function(E){var F=E.length;while(F--){E[F].remove()}});D.addNodeFilter("a",function(F){var H=F.length,I,E,G;while(H--){I=F[H];E=I.attr("href");G=I.attr("name");if(E&&E.indexOf("#_msocom_")!=-1){I.remove();continue}if(E&&E.indexOf("file://")===0){E=E.split("#")[1];if(E){E="#"+E}}if(!E&&!G){I.unwrap()}else{if(G&&!/^_?(?:toc|edn|ftn)/i.test(G)){I.unwrap();continue}I.attr({href:E,name:G})}}});var w=D.parse(C);if(s.paste_convert_word_fake_lists!==false){z(w)}A.content=new n({validate:s.validate},y).serialize(w)}})}p.isWordContent=q;return p});h("tinymce/pasteplugin/Quirks",["tinymce/Env","tinymce/util/Tools","tinymce/pasteplugin/WordFilter","tinymce/pasteplugin/Utils"],function(i,j,l,k){return function(o){function p(q){o.on("BeforePastePreProcess",function(r){r.content=q(r.content)})}function n(q){if(!l.isWordContent(q)){return q}var r=[];j.each(o.schema.getBlockElements(),function(u,t){r.push(t)});var s=new RegExp("(?:<br>&nbsp;[\\s\\r\\n]+|<br>)*(<\\/?("+r.join("|")+")[^>]*>)(?:<br>&nbsp;[\\s\\r\\n]+|<br>)*","g");q=k.filter(q,[[s,"$1"]]);q=k.filter(q,[[/<br><br>/g,"<BR><BR>"],[/<br>/g," "],[/<BR><BR>/g,"<br>"]]);return q}function m(s){if(l.isWordContent(s)){return s}var q=o.settings.paste_webkit_styles;if(o.settings.paste_remove_styles_if_webkit===false||q=="all"){return s}if(q){q=q.split(/[, ]/)}if(q){var t=o.dom,r=o.selection.getNode();s=s.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,function(B,z,A,u){var v=t.parseStyle(A,"span"),y={};if(q==="none"){return z+u}for(var x=0;x<q.length;x++){var w=v[q[x]],C=t.getStyle(r,q[x],true);if(/color/.test(q[x])){w=t.toHex(w);C=t.toHex(C)}if(C!=w){y[q[x]]=w}}y=t.serializeStyle(y,"span");if(y){return z+' style="'+y+'"'+u}return z+u})}else{s=s.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,"$1$3")}s=s.replace(/(<[^>]+) data-mce-style="([^"]+)"([^>]*>)/gi,function(u,w,v,x){return w+' style="'+v+'"'+x});return s}if(i.webkit){p(m)}if(i.ie){p(n)}}});h("tinymce/pasteplugin/Plugin",["tinymce/PluginManager","tinymce/pasteplugin/Clipboard","tinymce/pasteplugin/WordFilter","tinymce/pasteplugin/Quirks"],function(i,m,l,j){var k;i.add("paste",function(q){var o=this,r,p=q.settings;function n(){if(r.pasteFormat=="text"){this.active(false);r.pasteFormat="html"}else{r.pasteFormat="text";this.active(true);if(!k){var s=q.translate("Paste is now in plain text mode. Contents will now be pasted as plain text until you toggle this option off.");q.notificationManager.open({text:s,type:"info"});k=true}}}o.clipboard=r=new m(q);o.quirks=new j(q);o.wordFilter=new l(q);if(q.settings.paste_as_text){o.clipboard.pasteFormat="text"}if(p.paste_preprocess){q.on("PastePreProcess",function(s){p.paste_preprocess.call(o,o,s)})}if(p.paste_postprocess){q.on("PastePostProcess",function(s){p.paste_postprocess.call(o,o,s)})}q.addCommand("mceInsertClipboardContent",function(t,s){if(s.content){o.clipboard.pasteHtml(s.content)}if(s.text){o.clipboard.pasteText(s.text)}});if(q.paste_block_drop){q.on("dragend dragover draggesture dragdrop drop drag",function(s){s.preventDefault();s.stopPropagation()})}if(!q.settings.paste_data_images){q.on("drop",function(t){var s=t.dataTransfer;if(s&&s.files&&s.files.length>0){t.preventDefault()}})}q.addButton("pastetext",{icon:"pastetext",tooltip:"Paste as text",onclick:n,active:o.clipboard.pasteFormat=="text"});q.addMenuItem("pastetext",{text:"Paste as text",selectable:true,active:r.pasteFormat,onclick:n})})});a(["tinymce/pasteplugin/Utils"])})(this);